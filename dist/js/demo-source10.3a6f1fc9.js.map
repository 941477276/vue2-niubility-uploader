{"version":3,"sources":["webpack:///./src/views/usage-demos/PictureCard.vue?890c"],"names":[],"mappings":"iHAAA,OAAe","file":"js/demo-source10.3a6f1fc9.js","sourcesContent":["export default \"<template>\\r\\n  <FileUploader\\r\\n    :max-concurrent-uploads=\\\"3\\\"\\r\\n    :before-upload=\\\"onBeforeUpload\\\"\\r\\n    :request-handler=\\\"requestHandler\\\"\\r\\n    drag\\r\\n    list-type=\\\"picture-card\\\"\\r\\n    :limit=\\\"3\\\"\\r\\n    multiple\\r\\n    @file-added=\\\"onFileAdded\\\"></FileUploader>\\r\\n</template>\\r\\n\\r\\n<script>\\r\\nimport FileUploader from '@/components/uploader/FileUploader.vue'\\r\\n\\r\\nexport default {\\r\\n  name: \\\"PictureCard\\\",\\r\\n  components: { FileUploader },\\r\\n  data () {\\r\\n    return {\\r\\n\\r\\n    };\\r\\n  },\\r\\n  methods: {\\r\\n    onFileAdded (file) {\\r\\n      console.log('文件添加:', file);\\r\\n    },\\r\\n    /**\\r\\n     * 请求处理器\\r\\n     * @param fileData\\r\\n     */\\r\\n    requestHandler (fileData) {\\r\\n      console.log('requestHandler', fileData);\\r\\n      let {\\r\\n        file,\\r\\n        isUploadChunk,\\r\\n        chunk,\\r\\n        // id,\\r\\n        chunkIndex,\\r\\n        name,\\r\\n        fileData: chunkFileData\\r\\n      } = fileData;\\r\\n\\r\\n      if (!isUploadChunk) { // 上传单个文件\\r\\n        return {\\r\\n          url: 'http://localhost:3001/upload',\\r\\n          method: 'POST',\\r\\n          data: {\\r\\n            file: file,\\r\\n            name\\r\\n          }\\r\\n        };\\r\\n      }\\r\\n      let formData = new FormData();\\r\\n      formData.append('file', chunk);\\r\\n      formData.append('fileName', chunkFileData.file.name);\\r\\n      formData.append('uploadId', chunkFileData.id);\\r\\n      formData.append('chunkIndex', chunkIndex);\\r\\n      formData.append('totalChunks', chunkFileData.chunks);\\r\\n      formData.append('chunkMd5', fileData.extraData.chunkMd5);\\r\\n      return { // 上传分片文件\\r\\n        url: 'http://localhost:3001/upload/chunk',\\r\\n        method: 'POST',\\r\\n        data: formData\\r\\n      }\\r\\n    },\\r\\n    /**\\r\\n     *  请求响应处理器\\r\\n     * @param fileData\\r\\n     * @returns {Promise<never>}\\r\\n     */\\r\\n    respondHandler (fileData) {\\r\\n      console.log('respondHandler', fileData);\\r\\n    },\\r\\n    onBeforeUpload (fileData) {\\r\\n      if (!fileData.useChunked) {\\r\\n        return Promise.resolve();\\r\\n      }\\r\\n\\r\\n      return new Promise((resolve, reject) => {\\r\\n        const xhr = new XMLHttpRequest();\\r\\n        const data = {\\r\\n          uploadId: fileData.id,\\r\\n          fileName: fileData.file.name,\\r\\n          fileSize: fileData.file.size,\\r\\n          fileType: fileData.file.type,\\r\\n        };\\r\\n\\r\\n        xhr.open('POST', 'http://localhost:3001/upload/init');\\r\\n        xhr.setRequestHeader('Content-Type', 'application/json;charset=UTF-8');\\r\\n        xhr.addEventListener('load', () => {\\r\\n          if (xhr.status >= 200 && xhr.status < 300) {\\r\\n            try {\\r\\n              const response = JSON.parse(xhr.responseText);\\r\\n              resolve(response);\\r\\n            } catch (e) {\\r\\n              reject(new Error('Invalid response from server'));\\r\\n            }\\r\\n          } else {\\r\\n            reject(new Error(`HTTP ${xhr.status}: ${xhr.statusText}`));\\r\\n          }\\r\\n        });\\r\\n        xhr.addEventListener('error', () => {\\r\\n          reject(new Error('Network error occurred during upload initialization'));\\r\\n        });\\r\\n        xhr.send(JSON.stringify(data));\\r\\n      });\\r\\n    }\\r\\n  }\\r\\n}\\r\\n</script>\\r\\n\";"],"sourceRoot":""}